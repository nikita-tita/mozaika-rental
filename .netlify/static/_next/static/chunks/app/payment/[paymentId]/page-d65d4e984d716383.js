(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7819],{18533:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(72895).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},22915:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(72895).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},27414:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(72895).A)("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]])},33177:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>x});var t=a(95155),l=a(12115),c=a(41665),r=a(18533),n=a(81586),i=a(28199),d=a(27414),m=a(22915);function x(e){var s,a,x,h;let{params:o}=e,[j,u]=(0,l.useState)(null),[y,p]=(0,l.useState)(!0),[g,N]=(0,l.useState)(null),[b,f]=(0,l.useState)("card"),[v,w]=(0,l.useState)({number:"",expiry:"",cvv:"",holder:""}),[k,A]=(0,l.useState)(!1);(0,l.useEffect)(()=>{C()},[o.paymentId]);let C=async()=>{try{let e=await fetch("/api/payments/".concat(o.paymentId,"/public")),s=await e.json();s.success?u(s.data):N(s.error||"Платеж не найден")}catch(e){N("Ошибка загрузки платежа")}finally{p(!1)}},S=async()=>{if(j){A(!0);try{let e=await fetch("/api/payments/".concat(o.paymentId,"/process"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:b,cardData:"card"===b?v:void 0})}),s=await e.json();s.success?(alert("Оплата прошла успешно!"),window.location.href="/payment/".concat(o.paymentId,"/success")):N(s.error||"Ошибка при обработке платежа")}catch(e){N("Ошибка при обработке платежа")}finally{A(!1)}}};return y?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Загрузка платежа..."})]})}):g||!j?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)(c.zk,{className:"p-8 max-w-md w-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(r.A,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ошибка"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:g||"Платеж не найден"}),(0,t.jsx)(c.Pd,{onClick:()=>window.history.back(),children:"Вернуться назад"})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center justify-center",children:[(0,t.jsx)(n.A,{className:"w-8 h-8 mr-3 text-blue-600"}),"Оплата аренды"]}),(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Безопасная оплата через защищенное соединение"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)(c.zk,{className:"p-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,t.jsx)(i.A,{className:"w-5 h-5 mr-2"}),"Детали платежа"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Объект недвижимости:"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:(null==(s=j.property)?void 0:s.title)||"Не указан"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Адрес:"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:(null==(a=j.property)?void 0:a.address)||"Не указан"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Арендатор:"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:(null==(x=j.deal)?void 0:x.tenant)?"".concat(j.deal.tenant.firstName," ").concat(j.deal.tenant.lastName):"Не указан"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Дата оплаты:"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:new Date(j.dueDate).toLocaleDateString("ru-RU")})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Сумма к оплате:"}),(0,t.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[j.amount.toLocaleString()," ₽"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Статус:"}),(0,t.jsx)(c.a,{variant:"PAID"===j.status?"success":"OVERDUE"===j.status?"error":"info",children:"PAID"===j.status?"Оплачен":"OVERDUE"===j.status?"Просрочен":"Ожидает оплаты"})]})]})]}),(0,t.jsxs)(c.zk,{className:"p-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[(0,t.jsx)(n.A,{className:"w-5 h-5 mr-2"}),"Способ оплаты"]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Выберите способ оплаты"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"radio",name:"paymentMethod",value:"card",checked:"card"===b,onChange:e=>f(e.target.value),className:"mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:"Банковская карта"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Visa, MasterCard, МИР"})]})]}),(0,t.jsxs)("label",{className:"flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"radio",name:"paymentMethod",value:"bank",checked:"bank"===b,onChange:e=>f(e.target.value),className:"mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:"Банковский перевод"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"СБП, банковский перевод"})]})]})]})]}),"card"===b&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Номер карты"}),(0,t.jsx)(c.V$,{type:"text",placeholder:"1234 5678 9012 3456",value:v.number,onChange:e=>w(s=>({...s,number:e.target.value}))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Срок действия"}),(0,t.jsx)(c.V$,{type:"text",placeholder:"MM/YY",value:v.expiry,onChange:e=>w(s=>({...s,expiry:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV"}),(0,t.jsx)(c.V$,{type:"text",placeholder:"123",value:v.cvv,onChange:e=>w(s=>({...s,cvv:e.target.value}))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Владелец карты"}),(0,t.jsx)(c.V$,{type:"text",placeholder:"IVAN IVANOV",value:v.holder,onChange:e=>w(s=>({...s,holder:e.target.value}))})]})]}),"bank"===b&&(0,t.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Реквизиты для оплаты:"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Банк:"}),(0,t.jsx)("span",{className:"font-medium",children:"Тинькофф Банк"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Счет:"}),(0,t.jsx)("span",{className:"font-medium",children:"40702810123456789012"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"БИК:"}),(0,t.jsx)("span",{className:"font-medium",children:"044525974"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Получатель:"}),(0,t.jsx)("span",{className:"font-medium",children:'ООО "Риэлтор"'})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Назначение:"}),(0,t.jsxs)("span",{className:"font-medium",children:["Оплата аренды ",null==(h=j.property)?void 0:h.title]})]})]})]}),(0,t.jsx)(c.Pd,{onClick:S,disabled:k||"PAID"===j.status,className:"w-full",children:k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Обработка..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"PAID"===j.status?"Уже оплачен":"Оплатить ".concat(j.amount.toLocaleString()," ₽")]})}),(0,t.jsxs)("div",{className:"text-center text-sm text-gray-500",children:[(0,t.jsx)(m.A,{className:"w-4 h-4 inline mr-1"}),"Оплата защищена SSL-шифрованием"]})]})]})]})]})})}},53052:(e,s,a)=>{Promise.resolve().then(a.bind(a,33177))}},e=>{e.O(0,[7910,1665,8441,5964,7358],()=>e(e.s=53052)),_N_E=e.O()}]);