(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2121],{4229:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},15313:(e,s,a)=>{"use strict";a.d(s,{O:()=>h});var l=a(95155),t=a(12115),r=a(35695),i=a(54789),c=a(6874),d=a.n(c),n=a(41665),m=a(32919),x=a(92138);function o(e){let{title:s="Требуется авторизация",message:a="Для доступа к этой странице необходимо войти в систему",showRegisterLink:t=!0}=e;return(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center",children:(0,l.jsx)(m.A,{className:"w-8 h-8 text-white"})})}),(0,l.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:s}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:a})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(d(),{href:"/login",className:"w-full",children:(0,l.jsxs)(n.Pd,{className:"w-full",children:["Войти в систему",(0,l.jsx)(x.A,{className:"w-4 h-4 ml-2"})]})}),t&&(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Нет аккаунта?"," ",(0,l.jsx)(d(),{href:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Зарегистрироваться"})]})})]})]})})}function h(e){let{children:s,fallback:a,title:c,message:d}=e,{user:n,loading:m,isAuthenticated:x}=(0,i.n)(),h=(0,r.useRouter)();return((0,t.useEffect)(()=>{m||x||(console.log("\uD83D\uDEE1️ Попытка доступа к защищенной странице без авторизации"),h.push("/login"))},[m,x,h]),m)?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Проверка авторизации..."})]})}):x?(0,l.jsx)(l.Fragment,{children:s}):a?(0,l.jsx)(l.Fragment,{children:a}):(0,l.jsx)(o,{title:c,message:d})}},23663:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>j});var l=a(95155),t=a(12115),r=a(35695),i=a(41665),c=a(35169),d=a(29869),n=a(4229),m=a(6874),x=a.n(m),o=a(15313);let h=[{value:"APARTMENT",label:"Квартира"},{value:"HOUSE",label:"Дом"},{value:"COMMERCIAL",label:"Коммерческое помещение"},{value:"LAND",label:"Земельный участок"}],p=[{value:"Москва",label:"Москва"},{value:"Санкт-Петербург",label:"Санкт-Петербург"},{value:"Пушкино",label:"Пушкино"},{value:"Другой",label:"Другой"}];function j(){let e=(0,r.useRouter)(),[s,a]=(0,t.useState)(!1),[m,j]=(0,t.useState)(""),[u,g]=(0,t.useState)({title:"",type:"",address:"",city:"",district:"",area:"",rooms:"",bedrooms:"",bathrooms:"",pricePerMonth:"",deposit:"",description:"",images:[]}),b=e=>{let{name:s,value:a}=e.target;g(e=>({...e,[s]:a})),m&&j("")},y=(e,s)=>{g(a=>({...a,[s]:e})),m&&j("")},N=async s=>{s.preventDefault(),a(!0),j("");try{let s=new FormData;Object.entries(u).forEach(e=>{let[a,l]=e;"images"===a?u.images.forEach((e,a)=>{s.append("images[".concat(a,"]"),e)}):""!==l&&s.append(a,l)}),console.log("Отправляем данные:",Object.fromEntries(s));let a=await fetch("/api/properties",{method:"POST",body:s}),l=await a.json();if(a.ok&&l.success)console.log("Объект успешно создан:",l.data),e.push("/properties");else{let e=l.error||"Ошибка при создании объекта";console.error("Ошибка создания объекта:",e),j(e)}}catch(e){console.error("Error creating property:",e),j("Ошибка соединения с сервером")}finally{a(!1)}};return(0,l.jsx)(o.O,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)(x(),{href:"/properties",className:"mr-4",children:(0,l.jsxs)(i.Pd,{variant:"ghost",size:"sm",children:[(0,l.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Назад"]})}),(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Добавить объект"})]}),(0,l.jsx)("p",{className:"text-gray-600",children:"Заполните информацию о новом объекте недвижимости"})]}),(0,l.jsx)("form",{onSubmit:N,children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,l.jsxs)("div",{className:"lg:col-span-2",children:[(0,l.jsxs)(i.zk,{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Основная информация"}),m&&(0,l.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:m}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Название объекта ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(i.V$,{name:"title",value:u.title,onChange:b,placeholder:"Например: 2-к квартира в центре",required:!0})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Тип недвижимости ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(i.H1,{value:u.type,onChange:e=>y(e,"type"),options:h,placeholder:"Выберите тип"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Город ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(i.H1,{value:u.city,onChange:e=>y(e,"city"),options:p,placeholder:"Выберите город"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Адрес ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(i.V$,{name:"address",value:u.address,onChange:b,placeholder:"Улица, дом, квартира",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Район"}),(0,l.jsx)(i.V$,{name:"district",value:u.district,onChange:b,placeholder:"Название района"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Описание"}),(0,l.jsx)(i.JH,{name:"description",value:u.description,onChange:b,placeholder:"Подробное описание объекта, особенности, удобства...",rows:4})]})]})]}),(0,l.jsxs)(i.zk,{className:"p-6 mt-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Характеристики"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Общая площадь (м\xb2)"}),(0,l.jsx)(i.V$,{name:"area",type:"number",value:u.area,onChange:b,placeholder:"0",min:"0",step:"0.1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Количество комнат"}),(0,l.jsx)(i.V$,{name:"rooms",type:"number",value:u.rooms,onChange:b,placeholder:"0",min:"0"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Спальни"}),(0,l.jsx)(i.V$,{name:"bedrooms",type:"number",value:u.bedrooms,onChange:b,placeholder:"0",min:"0"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ванные комнаты"}),(0,l.jsx)(i.V$,{name:"bathrooms",type:"number",value:u.bathrooms,onChange:b,placeholder:"0",min:"0"})]})]})]}),(0,l.jsxs)(i.zk,{className:"p-6 mt-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Финансовые условия"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Арендная плата (₽/мес) ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(i.V$,{name:"pricePerMonth",type:"number",value:u.pricePerMonth,onChange:b,placeholder:"0",required:!0,min:"0",step:"100"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Депозит (₽)"}),(0,l.jsx)(i.V$,{name:"deposit",type:"number",value:u.deposit,onChange:b,placeholder:"0",min:"0",step:"100"})]})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)(i.zk,{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Фотографии"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,l.jsx)(d.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("label",{htmlFor:"image-upload",className:"cursor-pointer",children:(0,l.jsx)(i.Pd,{variant:"outline",type:"button",children:"Загрузить фото"})}),(0,l.jsx)("input",{id:"image-upload",type:"file",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let s=Array.from(e.target.files);g(e=>({...e,images:[...e.images,...s]}))}},className:"hidden"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"JPG, PNG до 10 МБ"})]}),u.images.length>0&&(0,l.jsx)("div",{className:"space-y-2",children:u.images.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,l.jsx)("span",{className:"text-sm truncate",children:e.name}),(0,l.jsx)("button",{type:"button",onClick:()=>{g(e=>({...e,images:e.images.filter((e,a)=>a!==s)}))},className:"text-red-500 hover:text-red-700",children:"✕"})]},s))})]})]}),(0,l.jsx)(i.zk,{className:"p-6 mt-6",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(i.Pd,{type:"submit",disabled:s,className:"w-full",children:s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Создание..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.A,{className:"w-4 h-4 mr-2"}),"Создать объект"]})}),(0,l.jsx)(x(),{href:"/properties",children:(0,l.jsx)(i.Pd,{variant:"outline",className:"w-full",children:"Отмена"})})]})})]})]})})]})})})}},29869:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32919:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},34342:(e,s,a)=>{Promise.resolve().then(a.bind(a,23663))},92138:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])}},e=>{e.O(0,[7910,1665,8441,5964,7358],()=>e(e.s=34342)),_N_E=e.O()}]);