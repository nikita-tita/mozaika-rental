(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2775],{4229:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(72895).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},15313:(e,s,r)=>{"use strict";r.d(s,{O:()=>h});var t=r(95155),a=r(12115),l=r(35695),i=r(54789),c=r(6874),n=r.n(c),d=r(41665),o=r(32919),m=r(92138);function x(e){let{title:s="Требуется авторизация",message:r="Для доступа к этой странице необходимо войти в систему",showRegisterLink:a=!0}=e;return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)(o.A,{className:"w-8 h-8 text-white"})})}),(0,t.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:s}),(0,t.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:r})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(n(),{href:"/login",className:"w-full",children:(0,t.jsxs)(d.Pd,{className:"w-full",children:["Войти в систему",(0,t.jsx)(m.A,{className:"w-4 h-4 ml-2"})]})}),a&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Нет аккаунта?"," ",(0,t.jsx)(n(),{href:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Зарегистрироваться"})]})})]})]})})}function h(e){let{children:s,fallback:r,title:c,message:n}=e,{user:d,loading:o,isAuthenticated:m}=(0,i.n)(),h=(0,l.useRouter)();return((0,a.useEffect)(()=>{o||m||(console.log("\uD83D\uDEE1️ Попытка доступа к защищенной странице без авторизации"),h.push("/login"))},[o,m,h]),o)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Проверка авторизации..."})]})}):m?(0,t.jsx)(t.Fragment,{children:s}):r?(0,t.jsx)(t.Fragment,{children:r}):(0,t.jsx)(x,{title:c,message:n})}},16768:(e,s,r)=>{Promise.resolve().then(r.bind(r,20837))},20837:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>p});var t=r(95155),a=r(12115),l=r(35695),i=r(6874),c=r.n(i),n=r(41665),d=r(35169),o=r(54416),m=r(4229),x=r(15313);let h=[{value:"APARTMENT",label:"Квартира"},{value:"HOUSE",label:"Дом"},{value:"STUDIO",label:"Студия"},{value:"COMMERCIAL",label:"Коммерческая"},{value:"ROOM",label:"Комната"}];function p(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),r=e.id,[i,p]=(0,a.useState)(null),[u,j]=(0,a.useState)(!0),[g,y]=(0,a.useState)(!1),[b,f]=(0,a.useState)({title:"",description:"",type:"APARTMENT",address:"",area:"",bedrooms:"",bathrooms:"",pricePerMonth:"",features:[]});(0,a.useEffect)(()=>{r&&v()},[r]);let v=async()=>{try{let l=await fetch("/api/properties/".concat(r)),i=await l.json();if(i.success){var e,s,t,a;let r=i.data;p(r),f({title:r.title||"",description:r.description||"",type:r.type||"APARTMENT",address:r.address||"",area:(null==(e=r.area)?void 0:e.toString())||"",bedrooms:(null==(s=r.bedrooms)?void 0:s.toString())||"",bathrooms:(null==(t=r.bathrooms)?void 0:t.toString())||"",pricePerMonth:(null==(a=r.pricePerMonth)?void 0:a.toString())||"",features:r.features||[]})}else console.error("Error fetching property:",i.error)}catch(e){console.error("Error fetching property:",e)}finally{j(!1)}},N=async e=>{e.preventDefault(),y(!0);try{let e=await fetch("/api/properties/".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b.title,description:b.description,type:b.type,address:b.address,area:parseFloat(b.area)||0,bedrooms:parseInt(b.bedrooms)||null,bathrooms:parseInt(b.bathrooms)||null,pricePerMonth:parseFloat(b.pricePerMonth)||0,features:b.features})}),t=await e.json();t.success?s.push("/properties/".concat(r)):alert("Ошибка при сохранении: "+t.error)}catch(e){console.error("Error updating property:",e),alert("Ошибка при сохранении объекта")}finally{y(!1)}},w=(e,s)=>{f(r=>({...r,[e]:s}))};return u?(0,t.jsx)(x.O,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}):i?(0,t.jsx)(x.O,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)(c(),{href:"/properties/".concat(r),className:"flex items-center text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Назад к объекту"]}),(0,t.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Редактирование объекта"})]})})}),(0,t.jsx)("main",{className:"max-w-4xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,t.jsx)(n.zk,{className:"p-6",children:(0,t.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Основная информация"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Название объекта *"}),(0,t.jsx)(n.V$,{value:b.title,onChange:e=>w("title",e.target.value),placeholder:"Введите название объекта",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип недвижимости *"}),(0,t.jsx)(n.H1,{value:b.type,onChange:e=>w("type",e),options:h})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Адрес *"}),(0,t.jsx)(n.V$,{value:b.address,onChange:e=>w("address",e.target.value),placeholder:"Введите полный адрес",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание"}),(0,t.jsx)(n.JH,{value:b.description,onChange:e=>w("description",e.target.value),placeholder:"Опишите особенности объекта",rows:4})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Характеристики"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Площадь (м\xb2)"}),(0,t.jsx)(n.V$,{type:"number",value:b.area,onChange:e=>w("area",e.target.value),placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Спальни"}),(0,t.jsx)(n.V$,{type:"number",value:b.bedrooms,onChange:e=>w("bedrooms",e.target.value),placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ванные"}),(0,t.jsx)(n.V$,{type:"number",value:b.bathrooms,onChange:e=>w("bathrooms",e.target.value),placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Цена за месяц (₽) *"}),(0,t.jsx)(n.V$,{type:"number",value:b.pricePerMonth,onChange:e=>w("pricePerMonth",e.target.value),placeholder:"0",required:!0})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,t.jsx)(c(),{href:"/properties/".concat(r),children:(0,t.jsxs)(n.Pd,{variant:"outline",children:[(0,t.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Отмена"]})}),(0,t.jsxs)(n.Pd,{type:"submit",disabled:g,children:[(0,t.jsx)(m.A,{className:"h-4 w-4 mr-2"}),g?"Сохранение...":"Сохранить"]})]})]})})})]})}):(0,t.jsx)(x.O,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Объект не найден"}),(0,t.jsx)(c(),{href:"/properties",children:(0,t.jsxs)(n.Pd,{children:[(0,t.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Вернуться к списку"]})})]})})})}},32919:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(72895).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},92138:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(72895).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])}},e=>{e.O(0,[7910,1665,8441,5964,7358],()=>e(e.s=16768)),_N_E=e.O()}]);