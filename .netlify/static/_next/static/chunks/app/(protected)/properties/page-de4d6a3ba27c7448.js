(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5156],{15313:(e,s,a)=>{"use strict";a.d(s,{O:()=>h});var l=a(95155),t=a(12115),r=a(35695),c=a(54789),i=a(6874),n=a.n(i),d=a(41665),m=a(32919),x=a(92138);function o(e){let{title:s="Требуется авторизация",message:a="Для доступа к этой странице необходимо войти в систему",showRegisterLink:t=!0}=e;return(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center",children:(0,l.jsx)(m.A,{className:"w-8 h-8 text-white"})})}),(0,l.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:s}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:a})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(n(),{href:"/login",className:"w-full",children:(0,l.jsxs)(d.Pd,{className:"w-full",children:["Войти в систему",(0,l.jsx)(x.A,{className:"w-4 h-4 ml-2"})]})}),t&&(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["Нет аккаунта?"," ",(0,l.jsx)(n(),{href:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Зарегистрироваться"})]})})]})]})})}function h(e){let{children:s,fallback:a,title:i,message:n}=e,{user:d,loading:m,isAuthenticated:x}=(0,c.n)(),h=(0,r.useRouter)();return((0,t.useEffect)(()=>{m||x||(console.log("\uD83D\uDEE1️ Попытка доступа к защищенной странице без авторизации"),h.push("/login"))},[m,x,h]),m)?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Проверка авторизации..."})]})}):x?(0,l.jsx)(l.Fragment,{children:s}):a?(0,l.jsx)(l.Fragment,{children:a}):(0,l.jsx)(o,{title:i,message:n})}},17205:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>v});var l=a(95155),t=a(12115),r=a(6874),c=a.n(r),i=a(41665),n=a(28199),d=a(17580),m=a(47924),x=a(72895);let o=(0,x.A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),h=(0,x.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);var u=a(4516),g=a(15313);let j=[{value:"",label:"Все типы"},{value:"APARTMENT",label:"Квартира"},{value:"HOUSE",label:"Дом"},{value:"ROOM",label:"Комната"},{value:"STUDIO",label:"Студия"}],p=[{value:"",label:"Любая цена"},{value:"0-20000",label:"До 20,000 ₽"},{value:"20000-40000",label:"20,000 - 40,000 ₽"},{value:"40000-60000",label:"40,000 - 60,000 ₽"},{value:"60000-100000",label:"60,000 - 100,000 ₽"},{value:"100000+",label:"От 100,000 ₽"}],b=[{value:"",label:"Все города"},{value:"Москва",label:"Москва"},{value:"Санкт-Петербург",label:"Санкт-Петербург"},{value:"Пушкино",label:"Пушкино"}];function v(){let[e,s]=(0,t.useState)([]),[a,r]=(0,t.useState)([]),[x,v]=(0,t.useState)(!0),[N,y]=(0,t.useState)({search:"",type:"",city:"",priceRange:"",minPrice:"",maxPrice:"",rooms:"",area:""}),[f,w]=(0,t.useState)(!1),[A,k]=(0,t.useState)("createdAt"),[P,C]=(0,t.useState)("desc");(0,t.useEffect)(()=>{R()},[]),(0,t.useEffect)(()=>{O()},[e,N,A,P]);let R=async()=>{try{let e=await fetch("/api/properties"),a=await e.json();a.success?s(a.data):console.error("Error fetching properties:",a.error)}catch(e){console.error("Error fetching properties:",e)}finally{v(!1)}},O=()=>{let s=[...e];if(N.search){let e=N.search.toLowerCase();s=s.filter(s=>s.title.toLowerCase().includes(e)||s.description.toLowerCase().includes(e)||s.address.toLowerCase().includes(e))}if(N.type&&(s=s.filter(e=>e.type===N.type)),N.city&&(s=s.filter(e=>{var s;return(null==(s=e.address.split(",")[0])?void 0:s.trim())===N.city})),N.priceRange){let[e,a]=N.priceRange.split("-").map(Number);s=s.filter(s=>{let l=s.pricePerMonth||0;return"100000+"===N.priceRange?l>=1e5:l>=e&&l<=a})}else(N.minPrice||N.maxPrice)&&(s=s.filter(e=>{let s=e.pricePerMonth||0,a=N.minPrice?Number(N.minPrice):0,l=N.maxPrice?Number(N.maxPrice):1/0;return s>=a&&s<=l}));N.rooms&&(s=s.filter(e=>{let s=e.bedrooms||0;return"4+"===N.rooms?s>=4:s===Number(N.rooms)})),N.area&&(s=s.filter(e=>(e.area||0)>=Number(N.area))),s.sort((e,s)=>{let a,l;switch(A){case"price":a=e.pricePerMonth||0,l=s.pricePerMonth||0;break;case"area":a=e.area||0,l=s.area||0;break;case"createdAt":default:a=new Date(e.createdAt).getTime(),l=new Date(s.createdAt).getTime();break;case"title":a=e.title.toLowerCase(),l=s.title.toLowerCase()}return"asc"===P?a>l?1:-1:a<l?1:-1}),r(s)},S=(e,s)=>{y(a=>({...a,[e]:s}))},E=e=>null==e||isNaN(e)?"Цена не указана":new Intl.NumberFormat("ru-RU").format(e);return x?(0,l.jsx)(g.O,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,l.jsx)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"animate-pulse",children:[(0,l.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,s)=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsx)("div",{className:"h-48 bg-gray-200 rounded mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},s))})]})})})}):(0,l.jsx)(g.O,{children:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,l.jsxs)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Недвижимость"}),(0,l.jsxs)("p",{className:"text-gray-600 mt-2",children:["Найдено ",a.length," объявлений"]})]}),(0,l.jsx)(c(),{href:"/properties/new",children:(0,l.jsx)(i.Pd,{className:"mt-4 md:mt-0",children:"Добавить объект"})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,l.jsx)(i.V$,{placeholder:"Поиск по адресу, району или описанию...",value:N.search,onChange:e=>S("search",e.target.value),className:"pl-10"})]})}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(i.H1,{value:"".concat(A,"-").concat(P),onChange:e=>{let[s,a]=e.split("-");k(s),C(a)},options:[{value:"createdAt-desc",label:"Сначала новые"},{value:"createdAt-asc",label:"Сначала старые"},{value:"price-asc",label:"Цена: по возрастанию"},{value:"price-desc",label:"Цена: по убыванию"},{value:"area-desc",label:"Площадь: по убыванию"},{value:"area-asc",label:"Площадь: по возрастанию"},{value:"title-asc",label:"Название: А-Я"},{value:"title-desc",label:"Название: Я-А"}]}),(0,l.jsxs)(i.Pd,{variant:"outline",onClick:()=>w(!f),className:"flex items-center",children:[(0,l.jsx)(o,{className:"h-4 w-4 mr-2"}),"Фильтры"]}),Object.values(N).some(e=>e)&&(0,l.jsx)(i.Pd,{variant:"outline",onClick:()=>{y({search:"",type:"",city:"",priceRange:"",minPrice:"",maxPrice:"",rooms:"",area:""})},children:"Очистить"})]})]}),f&&(0,l.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип недвижимости"}),(0,l.jsx)(i.H1,{value:N.type,onChange:e=>S("type",e),options:j})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Город"}),(0,l.jsx)(i.H1,{value:N.city,onChange:e=>S("city",e),options:b})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ценовой диапазон"}),(0,l.jsx)(i.H1,{value:N.priceRange,onChange:e=>S("priceRange",e),options:p})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Комнат"}),(0,l.jsx)(i.H1,{value:N.rooms,onChange:e=>S("rooms",e),options:[{value:"",label:"Любое"},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4+",label:"4+"}]})]})]})})]})]}),0===a.length?(0,l.jsxs)(i.zk,{className:"p-8 text-center",children:[(0,l.jsx)(m.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Объявления не найдены"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"Попробуйте изменить параметры поиска или добавьте новое объявление"}),(0,l.jsx)(c(),{href:"/properties/new",children:(0,l.jsx)(i.Pd,{children:"Добавить объявление"})})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>(0,l.jsx)(i.zk,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:(0,l.jsxs)(c(),{href:"/properties/".concat(e.id),children:[(0,l.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-200",children:e.images&&e.images.length>0?(0,l.jsx)("img",{src:e.images[0].url,alt:e.images[0].alt,className:"w-full h-48 object-cover"}):(0,l.jsx)("div",{className:"w-full h-48 bg-gray-200 flex items-center justify-center",children:(0,l.jsx)(n.A,{className:"h-12 w-12 text-gray-400"})})}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(e=>{switch(e){case"APARTMENT":case"HOUSE":case"STUDIO":default:return(0,l.jsx)(n.A,{className:"h-4 w-4"});case"ROOM":return(0,l.jsx)(d.A,{className:"h-4 w-4"})}})(e.type),(0,l.jsx)("span",{className:"ml-1",children:(e=>{let s=j.find(s=>s.value===e);return s?s.label:e})(e.type)})]}),(0,l.jsx)("button",{className:"text-gray-400 hover:text-red-500",children:(0,l.jsx)(h,{className:"h-4 w-4"})})]}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,l.jsx)(u.A,{className:"h-4 w-4 mr-1"}),(0,l.jsx)("span",{className:"line-clamp-1",children:e.address})]}),(0,l.jsx)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-3",children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[e.area&&(0,l.jsxs)("span",{children:[e.area," м\xb2"]}),e.bedrooms&&(0,l.jsxs)("span",{children:[e.bedrooms," комн."]}),e.bathrooms&&(0,l.jsxs)("span",{children:[e.bathrooms," ванн."]})]})}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-lg font-bold text-gray-900",children:[E(e.pricePerMonth)," ₽/мес"]}),e.deposit&&e.deposit>0&&(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["Залог: ",E(e.deposit)," ₽"]})]}),(0,l.jsx)("div",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleDateString("ru-RU")})]})]})]})},e.id))})]})})})}},32919:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},47924:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},66423:(e,s,a)=>{Promise.resolve().then(a.bind(a,17205))},92138:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(72895).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])}},e=>{e.O(0,[7910,1665,8441,5964,7358],()=>e(e.s=66423)),_N_E=e.O()}]);