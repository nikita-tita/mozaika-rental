(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4612],{4621:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(72895).A)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},34033:(e,s,t)=>{Promise.resolve().then(t.bind(t,86203))},47924:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(72895).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},86203:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(95155),l=t(12115),n=t(41665),r=t(57434),i=t(84616),c=t(47924),d=t(92657),o=t(4621),m=t(91788),x=t(28199),h=t(71007),u=t(69074),j=t(27414),p=t(24040);function N(e){let{isOpen:s,onClose:t,onSuccess:c}=e,[d,o]=(0,l.useState)([]),[m,x]=(0,l.useState)(!1),[h,u]=(0,l.useState)([]),[N,v]=(0,l.useState)(""),[g,y]=(0,l.useState)(!1),[f,b]=(0,l.useState)(!1),[w,_]=(0,l.useState)({title:"",dealId:"",monthlyRent:"",deposit:"",utilities:!1,additionalTerms:"",contractType:"standard"}),[D,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{s&&k()},[s]);let k=async()=>{try{let e=await fetch("/api/deals?status=IN_PROGRESS"),s=await e.json();s.success&&o(s.data)}catch(e){console.error("Error fetching deals:",e)}},C=async e=>{if(y(!1),e)try{let s=await fetch("/api/deals?status=IN_PROGRESS"),t=await s.json();t.success&&(o(t.data),t.data.find(s=>s.id===e)&&(A(e),b(!0),setTimeout(()=>b(!1),3e3)))}catch(e){console.error("Error fetching updated deals:",e),k()}else k()},R=async e=>{if(e.preventDefault(),x(!0),u([]),v(""),!D){u(["Выберите сделку для создания договора"]),x(!1);return}try{let e=await fetch("/api/contracts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...w,dealId:D.id,monthlyRent:parseFloat(w.monthlyRent)||D.monthlyRent,deposit:w.deposit?parseFloat(w.deposit):D.deposit,content:L(D,w)})}),s=await e.json();s.success?(v(s.message||"Договор успешно создан"),_({title:"",dealId:"",monthlyRent:"",deposit:"",utilities:!1,additionalTerms:"",contractType:"standard"}),S(null),setTimeout(()=>{v(""),t(),c()},2e3)):u([s.error||"Ошибка при создании договора"])}catch(e){console.error("Error creating contract:",e),u(["Ошибка при создании договора"])}finally{x(!1)}},A=e=>{let s=d.find(s=>s.id===e);s&&(S(s),_(e=>({...e,dealId:s.id,title:"Договор аренды - ".concat(s.property.title),monthlyRent:s.monthlyRent.toString(),deposit:s.deposit?s.deposit.toString():""})))},E=e=>{let{name:s,value:t,type:a}=e.target;_(l=>({...l,[s]:"checkbox"===a?e.target.checked:t}))},L=(e,s)=>{var t;let a=new Date(e.startDate).toLocaleDateString("ru-RU"),l=new Date(e.endDate).toLocaleDateString("ru-RU");return"ДОГОВОР АРЕНДЫ НЕДВИЖИМОСТИ\n\nг. Москва                                                                  ".concat(a,"\n\n").concat(e.landlord.firstName," ").concat(e.landlord.lastName,', именуемый в дальнейшем "Арендодатель", \nв лице ').concat(e.landlord.firstName," ").concat(e.landlord.lastName,", действующий на основании права собственности, \nс одной стороны, и ").concat(e.tenant.firstName," ").concat(e.tenant.lastName,', именуемый в дальнейшем "Арендатор", \nс другой стороны, заключили настоящий договор о нижеследующем:\n\n1. ПРЕДМЕТ ДОГОВОРА\n1.1. Арендодатель обязуется предоставить Арендатору во временное владение и пользование \nнедвижимое имущество: ').concat(e.property.title,", расположенное по адресу: ").concat(e.property.address,".\n\n2. СРОК ДЕЙСТВИЯ ДОГОВОРА\n2.1. Договор вступает в силу с ").concat(a," и действует до ").concat(l,".\n\n3. АРЕНДНАЯ ПЛАТА\n3.1. Размер арендной платы составляет ").concat(s.monthlyRent||e.monthlyRent," (").concat(T(parseInt(s.monthlyRent||e.monthlyRent.toString())),") рублей в месяц.\n3.2. Арендная плата вносится Арендатором ежемесячно не позднее 5-го числа каждого месяца.\n\n4. ЗАЛОГ\n4.1. При заключении договора Арендатор вносит залог в размере ").concat(s.deposit||e.deposit||0," (").concat(T(parseInt(s.deposit||(null==(t=e.deposit)?void 0:t.toString())||"0")),") рублей.\n\n5. ПРАВА И ОБЯЗАННОСТИ СТОРОН\n5.1. Арендодатель обязуется:\n- Передать Арендатору имущество в состоянии, соответствующем условиям договора\n- Не вмешиваться в хозяйственную деятельность Арендатора\n\n5.2. Арендатор обязуется:\n- Использовать имущество в соответствии с его назначением\n- Поддерживать имущество в исправном состоянии\n- Своевременно вносить арендную плату\n\n").concat(s.additionalTerms?"\n6. ДОПОЛНИТЕЛЬНЫЕ УСЛОВИЯ\n".concat(s.additionalTerms,"\n"):"","\n\n7. ЗАКЛЮЧИТЕЛЬНЫЕ ПОЛОЖЕНИЯ\n7.1. Договор составлен в двух экземплярах, имеющих равную юридическую силу.\n7.2. Все изменения и дополнения к договору действительны при письменном согласии сторон.\n\nАрендодатель:                                    Арендатор:\n").concat(e.landlord.firstName," ").concat(e.landlord.lastName,"                    ").concat(e.tenant.firstName," ").concat(e.tenant.lastName,"\nПаспорт: _________________                      Паспорт: _________________\nПодпись: _________________                      Подпись: _________________\nДата: _________________                         Дата: _________________")},T=e=>{let s=["","один","два","три","четыре","пять","шесть","семь","восемь","девять"];if(0===e)return"ноль";if(e<10)return s[e];if(e<20)return["десять","одиннадцать","двенадцать","тринадцать","четырнадцать","пятнадцать","шестнадцать","семнадцать","восемнадцать","девятнадцать"][e-10];if(e<100){let t=e%10;return["","","двадцать","тридцать","сорок","пятьдесят","шестьдесят","семьдесят","восемьдесят","девяносто"][Math.floor(e/10)]+(t>0?" "+s[t]:"")}if(e<1e3){let t=Math.floor(e/100),a=e%100;return(t>1?s[t]+" ":"")+"сто"+(a>0?" "+T(a):"")}if(e<1e6){let s=Math.floor(e/1e3),t=e%1e3;return T(s)+" тысяча"+(t>0?" "+T(t):"")}return e.toString()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.ih,{isOpen:s,onClose:t,title:"Создать договор аренды",children:(0,a.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[h.length>0&&(0,a.jsx)(n.N6,{variant:"error",title:"Ошибка",children:(0,a.jsx)("ul",{className:"list-disc list-inside",children:h.map((e,s)=>(0,a.jsx)("li",{children:e},s))})}),N&&(0,a.jsx)(n.N6,{variant:"success",title:"Успешно",children:N}),f&&(0,a.jsx)(n.N6,{variant:"success",title:"Новая сделка создана",children:"Новая сделка была успешно создана и автоматически выбрана для договора."}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-[#323130] mb-4 flex items-center",children:[(0,a.jsx)(r.A,{className:"w-5 h-5 mr-2"}),"Выбор сделки"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:["Выберите сделку ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.H1,{value:w.dealId,onChange:A,options:[{value:"",label:"Выберите сделку для создания договора"},...d.map(e=>({value:e.id,label:"".concat(e.title||e.property.title," - ").concat(e.property.address)}))]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Нет подходящей сделки?"}),(0,a.jsxs)(n.Pd,{type:"button",variant:"outline",size:"sm",onClick:()=>y(!0),className:"flex items-center",children:[(0,a.jsx)(i.A,{className:"w-4 h-4 mr-1"}),"Создать новую сделку"]})]})]})]}),D&&(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-blue-900 mb-3",children:"Информация о сделке"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-blue-800",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Объект:"})," ",D.property.title," - ",D.property.address]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Арендатор:"})," ",D.tenant.firstName," ",D.tenant.lastName]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Арендодатель:"})," ",D.landlord.firstName," ",D.landlord.lastName]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Период:"})," ",new Date(D.startDate).toLocaleDateString("ru-RU")," - ",new Date(D.endDate).toLocaleDateString("ru-RU")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Арендная плата:"})," ",D.monthlyRent," ₽/мес"]}),D.deposit>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Залог:"})," ",D.deposit," ₽"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-[#323130] mb-4 flex items-center",children:[(0,a.jsx)(r.A,{className:"w-5 h-5 mr-2"}),"Информация о договоре"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:["Название договора ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.V$,{name:"title",placeholder:"Название договора",value:w.title,onChange:E,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:"Тип договора"}),(0,a.jsx)(n.H1,{value:w.contractType,onChange:e=>_(s=>({...s,contractType:e})),options:[{value:"standard",label:"Стандартный договор аренды"},{value:"commercial",label:"Коммерческая аренда"},{value:"long_term",label:"Долгосрочная аренда"}]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-[#323130] mb-4 flex items-center",children:[(0,a.jsx)(j.A,{className:"w-5 h-5 mr-2"}),"Финансовые условия"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:["Арендная плата (₽/мес) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(n.V$,{name:"monthlyRent",type:"number",placeholder:"0",value:w.monthlyRent,onChange:E,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:"Залог (₽)"}),(0,a.jsx)(n.V$,{name:"deposit",type:"number",placeholder:"0",value:w.deposit,onChange:E})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"utilities",checked:w.utilities,onChange:E,className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm text-[#323130]",children:"Включить коммунальные услуги в арендную плату"})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-[#323130] mb-4 flex items-center",children:[(0,a.jsx)(r.A,{className:"w-5 h-5 mr-2"}),"Дополнительные условия"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-[#323130] mb-1",children:"Дополнительные пункты договора"}),(0,a.jsx)(n.JH,{name:"additionalTerms",placeholder:"Введите дополнительные условия договора...",value:w.additionalTerms,onChange:E,rows:4})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[(0,a.jsx)(n.Pd,{type:"button",variant:"outline",onClick:t,disabled:m,children:"Отмена"}),(0,a.jsx)(n.Pd,{type:"submit",disabled:m||!D,children:m?"Создание...":"Создать договор"})]})]})}),(0,a.jsx)(p.A,{isOpen:g,onClose:()=>y(!1),onSuccess:C})]})}let v=[{value:"ALL",label:"Все статусы"},{value:"DRAFT",label:"Черновик"},{value:"SIGNED",label:"Подписан"},{value:"EXPIRED",label:"Истек"},{value:"TERMINATED",label:"Расторгнут"}];function g(){var e,s,t,x,h;let[u,j]=(0,l.useState)([]),[p,g]=(0,l.useState)(!0),[f,b]=(0,l.useState)(!1),[w,_]=(0,l.useState)(null),[D,S]=(0,l.useState)(!1),[k,C]=(0,l.useState)(!1),[R,A]=(0,l.useState)(null),[E,L]=(0,l.useState)({status:"ALL",search:""}),[T,P]=(0,l.useState)("cards");(0,l.useEffect)(()=>{I()},[E]);let I=async()=>{g(!0);try{let e=new URLSearchParams;Object.entries(E).forEach(s=>{let[t,a]=s;a&&"ALL"!==a&&e.append(t,a)});let s=await fetch("/api/contracts?".concat(e)),t=await s.json();t.success&&j(t.data)}catch(e){console.error("Error fetching contracts:",e)}finally{g(!1)}},O=e=>{switch(e){case"DRAFT":return(0,a.jsx)(n.a,{variant:"warning",children:"Черновик"});case"SIGNED":return(0,a.jsx)(n.a,{variant:"success",children:"Подписан"});case"EXPIRED":return(0,a.jsx)(n.a,{variant:"error",children:"Истек"});case"TERMINATED":return(0,a.jsx)(n.a,{variant:"error",children:"Расторгнут"});default:return(0,a.jsx)(n.a,{variant:"default",children:"Неизвестно"})}},z=e=>{switch(e){case"DRAFT":return"Договор создан, но не подписан";case"SIGNED":return"Договор подписан и активен";case"EXPIRED":return"Срок действия договора истек";case"TERMINATED":return"Договор расторгнут досрочно";default:return"Статус не определен"}},U=e=>{_(e),S(!0)},M=e=>{_(e),C(!0)},F=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf";try{var t,a,l,n,r,i,c,d,o,m,x,h,u,j,p,N;let v={propertyTitle:(null==(a=e.deal)||null==(t=a.property)?void 0:t.title)||"Не указано",propertyAddress:(null==(n=e.deal)||null==(l=n.property)?void 0:l.address)||"Не указано",landlordName:"".concat((null==(i=e.deal)||null==(r=i.landlord)?void 0:r.firstName)||""," ").concat((null==(d=e.deal)||null==(c=d.landlord)?void 0:c.lastName)||"").trim()||"Не указано",tenantName:"".concat((null==(m=e.deal)||null==(o=m.tenant)?void 0:o.firstName)||""," ").concat((null==(h=e.deal)||null==(x=h.tenant)?void 0:x.lastName)||"").trim()||"Не указано",startDate:(null==(u=e.deal)?void 0:u.startDate)||new Date().toISOString(),endDate:(null==(j=e.deal)?void 0:j.endDate)||new Date().toISOString(),monthlyRent:(null==(p=e.deal)?void 0:p.monthlyRent)||0,deposit:(null==(N=e.deal)?void 0:N.deposit)||0,utilities:!1,additionalTerms:""},g=await fetch("/api/contracts/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contractData:v,fileType:s})});if(!g.ok){let e=await g.json().catch(()=>({}));throw Error(e.error||"Ошибка при генерации договора")}let y=await g.blob(),f=window.URL.createObjectURL(y),b=document.createElement("a");b.href=f,b.download="Договор_аренды_".concat(e.title.replace(/[^a-zA-Zа-яА-Я0-9]/g,"_"),"_").concat(new Date().toISOString().split("T")[0],".").concat("word"===s?"txt":"html"),document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(f),alert("Договор успешно скачан в формате ".concat(s.toUpperCase()))}catch(e){console.error("Ошибка при скачивании договора:",e),alert("Ошибка при скачивании договора. Попробуйте еще раз.")}},H=u.filter(e=>{if(E.search){var s,t,a,l,n,r,i,c,d,o,m,x,h,u,j;let p=E.search.toLowerCase();return(null==(s=e.title)?void 0:s.toLowerCase().includes(p))||(null==(l=e.deal)||null==(a=l.property)||null==(t=a.title)?void 0:t.toLowerCase().includes(p))||(null==(i=e.deal)||null==(r=i.property)||null==(n=r.address)?void 0:n.toLowerCase().includes(p))||"".concat(null==(d=e.deal)||null==(c=d.tenant)?void 0:c.firstName," ").concat(null==(m=e.deal)||null==(o=m.tenant)?void 0:o.lastName).toLowerCase().includes(p)||"".concat(null==(h=e.deal)||null==(x=h.landlord)?void 0:x.firstName," ").concat(null==(j=e.deal)||null==(u=j.landlord)?void 0:u.lastName).toLowerCase().includes(p)}return!0});return p?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-8"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)("div",{className:"h-96 bg-gray-200 rounded"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,a.jsx)("div",{className:"h-32 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-32 bg-gray-200 rounded"})]})]})]})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(r.A,{className:"w-8 h-8 mr-3 text-blue-600"}),"Каталог договоров"]}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Управление договорами аренды с возможностью создания, редактирования и скачивания"})]}),(0,a.jsx)("div",{className:"mb-6 flex justify-end",children:(0,a.jsx)(n.Pd,{onClick:()=>b(!0),icon:(0,a.jsx)(i.A,{className:"w-4 h-4"}),children:"Создать договор"})}),(0,a.jsx)("div",{className:"mb-6 space-y-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,a.jsx)(n.V$,{placeholder:"Поиск по названию, объекту, арендатору...",value:E.search,onChange:e=>L(s=>({...s,search:e.target.value})),className:"pl-10"})]})}),(0,a.jsx)(n.H1,{value:E.status,onChange:e=>L(s=>({...s,status:e})),options:v,placeholder:"Выберите статус",className:"w-full sm:w-48"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(n.Pd,{variant:"cards"===T?"primary":"outline",onClick:()=>P("cards"),size:"sm",children:"Карточки"}),(0,a.jsx)(n.Pd,{variant:"table"===T?"primary":"outline",onClick:()=>P("table"),size:"sm",children:"Таблица"})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Мои договоры (",H.length,")"]})}),0===H.length?(0,a.jsxs)(n.zk,{className:"p-8 text-center",children:[(0,a.jsx)(r.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:E.search||"ALL"!==E.status?"Договоры не найдены":"Нет созданных договоров"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:E.search||"ALL"!==E.status?"Попробуйте изменить параметры поиска":"Создайте первый договор на основе существующей сделки"}),!E.search&&"ALL"===E.status&&(0,a.jsx)(n.Pd,{onClick:()=>b(!0),icon:(0,a.jsx)(i.A,{className:"w-4 h-4"}),children:"Создать договор"})]}):"cards"===T?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:H.map(e=>(0,a.jsx)(y,{contract:e,getStatusBadge:O,getStatusDescription:z,onView:U,onEdit:M,onDownload:F,showDownloadMenu:R,setShowDownloadMenu:A},e.id))}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Договор"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Объект"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Дата создания"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(e=>{var s,t,l,r;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:(null==(t=e.deal)||null==(s=t.property)?void 0:s.title)||"Не указано"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:(null==(r=e.deal)||null==(l=r.property)?void 0:l.address)||"Адрес не указан"})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:O(e.status)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ru-RU")}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(n.Pd,{variant:"outline",size:"sm",onClick:()=>U(e),children:(0,a.jsx)(d.A,{className:"w-4 h-4"})}),(0,a.jsx)(n.Pd,{variant:"outline",size:"sm",onClick:()=>M(e),children:(0,a.jsx)(o.A,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(n.Pd,{variant:"outline",size:"sm",onClick:()=>A(e.id),children:(0,a.jsx)(m.A,{className:"w-4 h-4"})}),R===e.id&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("button",{onClick:()=>{F(e,"pdf"),A(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"\uD83D\uDCC4 Скачать PDF"}),(0,a.jsx)("button",{onClick:()=>{F(e,"word"),A(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"\uD83D\uDCDD Скачать Word"})]})})]})]})})]},e.id)})})]})})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(n.zk,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Статистика договоров"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Всего договоров:"}),(0,a.jsx)("span",{className:"font-semibold",children:u.length})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Активных:"}),(0,a.jsx)("span",{className:"font-semibold text-green-600",children:u.filter(e=>"SIGNED"===e.status).length})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Черновиков:"}),(0,a.jsx)("span",{className:"font-semibold text-yellow-600",children:u.filter(e=>"DRAFT"===e.status).length})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Истекших:"}),(0,a.jsx)("span",{className:"font-semibold text-red-600",children:u.filter(e=>"EXPIRED"===e.status).length})]})]})]}),(0,a.jsxs)(n.zk,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Статусы договоров"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.a,{variant:"warning",className:"mr-2",children:"Черновик"}),(0,a.jsx)("span",{children:"Договор создан, но не подписан"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.a,{variant:"success",className:"mr-2",children:"Подписан"}),(0,a.jsx)("span",{children:"Договор подписан и активен"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.a,{variant:"error",className:"mr-2",children:"Истек"}),(0,a.jsx)("span",{children:"Срок действия договора истек"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.a,{variant:"error",className:"mr-2",children:"Расторгнут"}),(0,a.jsx)("span",{children:"Договор расторгнут досрочно"})]})]})]})]})]})]}),(0,a.jsx)(n.ih,{isOpen:D,onClose:()=>S(!1),title:"Просмотр договора",size:"lg",children:w&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-3",children:w.title}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(null==(e=w.deal)?void 0:e.property)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Объект:"})," ",w.deal.property.title," - ",w.deal.property.address]}),(null==(s=w.deal)?void 0:s.tenant)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Арендатор:"})," ",w.deal.tenant.firstName," ",w.deal.tenant.lastName]}),(null==(t=w.deal)?void 0:t.landlord)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Арендодатель:"})," ",w.deal.landlord.firstName," ",w.deal.landlord.lastName]}),(null==(x=w.deal)?void 0:x.startDate)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Период:"})," ",new Date(w.deal.startDate).toLocaleDateString("ru-RU")," - ",new Date(w.deal.endDate).toLocaleDateString("ru-RU")]}),(null==(h=w.deal)?void 0:h.monthlyRent)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Сумма:"})," ",w.deal.monthlyRent.toLocaleString()," ₽/мес"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Статус:"})," ",O(w.status)]})]})]}),(0,a.jsxs)("div",{className:"bg-white border p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-gray-900",children:"Текст договора:"}),(0,a.jsx)("div",{className:"text-sm space-y-2 text-gray-900 max-h-96 overflow-y-auto",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap font-sans",children:w.content})})]})]})}),(0,a.jsx)(n.ih,{isOpen:k,onClose:()=>C(!1),title:"Редактирование договора",size:"lg",children:w&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(n.V$,{label:"Название договора",value:w.title,onChange:e=>_({...w,title:e.target.value})}),(0,a.jsx)(n.JH,{label:"Содержание договора",value:w.content,onChange:e=>_({...w,content:e.target.value}),rows:10}),(0,a.jsx)(n.H1,{value:w.status,onChange:e=>_({...w,status:e}),options:[{value:"DRAFT",label:"Черновик"},{value:"SIGNED",label:"Подписан"},{value:"EXPIRED",label:"Истек"},{value:"TERMINATED",label:"Расторгнут"}]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,a.jsx)(n.Pd,{onClick:()=>{j(e=>e.map(e=>e.id===w.id?w:e)),C(!1)},className:"flex-1",children:"Сохранить изменения"}),(0,a.jsx)(n.Pd,{variant:"outline",onClick:()=>C(!1),className:"flex-1",children:"Отмена"})]})]})}),(0,a.jsx)(N,{isOpen:f,onClose:()=>b(!1),onSuccess:I})]})}function y(e){var s,t,l,r;let{contract:i,getStatusBadge:c,getStatusDescription:j,onView:p,onEdit:N,onDownload:v,showDownloadMenu:g,setShowDownloadMenu:y}=e;return(0,a.jsxs)(n.zk,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:i.title}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(null==(s=i.deal)?void 0:s.property)&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-1"}),i.deal.property.title," - ",i.deal.property.address]}),(null==(t=i.deal)?void 0:t.tenant)&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-1"}),i.deal.tenant.firstName," ",i.deal.tenant.lastName]}),(null==(l=i.deal)?void 0:l.startDate)&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-1"}),new Date(i.deal.startDate).toLocaleDateString("ru-RU")," - ",new Date(i.deal.endDate).toLocaleDateString("ru-RU")]}),(null==(r=i.deal)?void 0:r.monthlyRent)&&(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[i.deal.monthlyRent.toLocaleString()," ₽/мес"]})]})]}),(0,a.jsx)("div",{className:"ml-4",children:c(i.status)})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-3",children:j(i.status)}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.Pd,{variant:"outline",size:"sm",onClick:()=>p(i),children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-1"}),"Просмотр"]}),(0,a.jsxs)(n.Pd,{variant:"outline",size:"sm",onClick:()=>N(i),children:[(0,a.jsx)(o.A,{className:"w-4 h-4 mr-1"}),"Редактировать"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)(n.Pd,{variant:"outline",size:"sm",onClick:()=>y(i.id),children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-1"}),"Скачать"]}),g===i.id&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10 border",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("button",{onClick:()=>{v(i,"pdf"),y(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"\uD83D\uDCC4 Скачать PDF"}),(0,a.jsx)("button",{onClick:()=>{v(i,"word"),y(null)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"\uD83D\uDCDD Скачать Word"})]})})]})]})]})}},91788:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(72895).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])}},e=>{e.O(0,[7910,1665,4040,8441,5964,7358],()=>e(e.s=34033)),_N_E=e.O()}]);