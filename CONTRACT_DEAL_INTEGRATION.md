# Интеграция создания сделок в форму договоров

## Описание изменений

Добавлена возможность создания новой сделки прямо из формы создания договора, что решает проблему блокировки процесса создания договора при отсутствии подходящей сделки.

## Внесенные изменения

### 1. Модификация CreateContractForm.tsx

- **Добавлен импорт** `CreateDealForm` компонента
- **Добавлено состояние** `showCreateDealForm` для управления модальным окном создания сделки
- **Добавлено состояние** `newDealCreated` для отображения уведомления о создании новой сделки
- **Добавлена кнопка** "Создать новую сделку" в секции выбора сделки
- **Интегрировано модальное окно** создания сделки
- **Реализована логика** автоматического выбора только что созданной сделки

### 2. Модификация CreateDealForm.tsx

- **Изменен интерфейс** `CreateDealFormProps` - добавлен параметр `dealId` в callback `onSuccess`
- **Модифицирована логика** успешного создания - теперь передается ID созданной сделки

### 3. Модификация API deals/route.ts

- **Изменен статус** создаваемой сделки с "DRAFT" на "IN_PROGRESS"
- **Улучшена читаемость** кода POST метода
- **Добавлена корректная обработка** ошибок

## Функциональность

### Новые возможности:

1. **Кнопка создания сделки** - отображается под селектором сделок с текстом "Нет подходящей сделки?"
2. **Модальное окно создания** - открывается при нажатии на кнопку, содержит полную форму создания сделки
3. **Автоматический выбор** - после создания сделки она автоматически выбирается в форме договора
4. **Уведомление** - показывается сообщение о том, что новая сделка создана и выбрана
5. **Обновление списка** - список сделок автоматически обновляется после создания новой

### Пользовательский опыт:

1. Пользователь открывает форму создания договора
2. Если нет подходящей сделки, нажимает "Создать новую сделку"
3. Заполняет форму создания сделки
4. После успешного создания сделка автоматически выбирается
5. Пользователь может продолжить создание договора

## Технические детали

### Состояния компонента:
- `showCreateDealForm: boolean` - управление видимостью модального окна
- `newDealCreated: boolean` - отображение уведомления о создании

### Callback функции:
- `handleCreateDealSuccess(dealId?: string)` - обработка успешного создания сделки
- Автоматическое обновление списка сделок
- Автоматический выбор новой сделки

### API изменения:
- Статус новой сделки: `IN_PROGRESS` (вместо `DRAFT`)
- Возврат полных данных сделки включая ID

## Результат

Теперь пользователи могут создавать договоры даже при отсутствии готовых сделок, что значительно улучшает пользовательский опыт и устраняет блокировку рабочего процесса. 